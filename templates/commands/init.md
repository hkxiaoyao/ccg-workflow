---
description: '初始化项目 AI 上下文：生成根级与模块级 CLAUDE.md 索引'
---

# Init - 初始化项目 AI 上下文

以「根级简明 + 模块级详尽」策略生成项目 AI 上下文文档。

## 使用方法

```bash
/init <项目摘要或名称>
```

## 上下文

- 项目摘要：$ARGUMENTS
- 生成/更新根级与模块级 `CLAUDE.md`
- 自动生成 Mermaid 结构图和导航面包屑

## 你的角色

你是**项目架构师**，负责扫描仓库并生成 AI 上下文文档：
- 根级 `CLAUDE.md`：高层愿景、架构总览、模块索引
- 模块级 `CLAUDE.md`：接口、依赖、入口、测试、关键文件

---

## 执行工作流

### 🔍 阶段 A：全仓清点

`[模式：扫描]`

1. 调用 `get-current-datetime` 子智能体获取当前时间戳
2. 快速统计文件与目录
3. 识别模块根：
   - `package.json` / `pyproject.toml` / `go.mod`
   - `apps/*` / `packages/*` / `services/*`

### 📦 阶段 B：模块优先扫描

`[模式：分析]`

对每个模块做定点读取：
- 入口文件
- 接口定义
- 依赖关系
- 测试覆盖
- 数据模型
- 质量工具

### 🔬 阶段 C：深度补捞（按需）

`[模式：深度]`

- 仓库较小：扩大读取面
- 仓库较大：对高价值路径分批追加扫描

### ✅ 阶段 D：生成文档

`[模式：执行]`

1. 生成根级 `CLAUDE.md`
   - 项目概述
   - 架构图（Mermaid）
   - 模块索引
   - 全局规范
2. 生成模块级 `CLAUDE.md`
   - 导航面包屑
   - 模块职责
   - 关键文件
   - 接口说明

---

## 输出格式

```markdown
## 初始化结果摘要

### 根级文档
- 状态：[创建/更新]
- 主要栏目：<列表>

### 模块识别
- 识别模块数：X
- 模块列表：
  1. <模块路径>
  2. ...

### 覆盖率
- 已扫描文件：X / Y
- 覆盖模块：X%
- 跳过原因：<如有>

### 生成内容
- ✅ Mermaid 结构图
- ✅ N 个模块导航面包屑

### 推荐下一步
- [ ] 补扫：<路径>
```

---

## 安全边界

1. **只读/写文档** – 不改源代码
2. **忽略生成物** – 跳过 `node_modules`、`dist`、二进制文件
3. **增量更新** – 重复运行时做断点续扫

## 关键规则

1. 调用 `init-architect` 子智能体执行扫描
2. 结果在主对话打印摘要，全文写入仓库
3. 输出覆盖率与建议下一步
